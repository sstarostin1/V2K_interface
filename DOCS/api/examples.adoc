= Примеры использования API

// Метаданные для машинной читаемости
:component: examples
:tags: [api, примеры, команды, использование]
:dependencies: [VCAS протокол]
:related: [api/interfaces.adoc]

== Примеры команд и ответов

=== Получение списка каналов

[source]
----
# Запрос списка каналов
Клиент -> Сервер: name:ChannelsList|method:get\n

# Ответ сервера
Сервер -> Клиент: name:ChannelsList|val:VEPP/FZ_tau,VEPP/Energy,BEP/Currents/pPMT\n
----

=== Получение информации о канале

[source]
----
# Запрос полной информации
Клиент -> Сервер: name:VEPP/Energy|method:getfull\n

# Ответ с деталями
Сервер -> Клиент: name:VEPP/Energy|type:ro|units:MeV|descr:Энергия пучка|val:1850.5|host:172.16.1.110|port:20041\n
----

=== Установка значения канала

[source]
----
# Установка нового значения
Клиент -> Сервер: name:VEPP/FZ_tau|method:set|val:1000\n

# Успешный ответ (пустой)
Сервер -> Клиент: \n
----

=== Обработка ошибок

[source]
----
# Запрос несуществующего канала
Клиент -> Сервер: name:NonExistent|method:getfull\n

# Ответ с ошибкой
Сервер -> Клиент: value:error|descr:Channel 'NonExistent' not found\n
----

== Сценарии использования

=== Мониторинг каналов
1. Подключиться к серверу
2. Получить список каналов
3. Для каждого интересующего канала запросить полную информацию
4. Настроить периодическое обновление значений

=== Управление параметрами
1. Проверить тип канала (должен быть `rw`)
2. Отправить команду `set` с новым значением
3. Обработать подтверждение или ошибку

=== Отладка подключения
1. Использовать mock сервер для тестирования
2. Проверить формат команд и парсинг ответов
3. Логировать все взаимодействия

Связанные документы:

* xref:api/interfaces.adoc[Интерфейсы и протокол] - полное описание команд.
* xref:guides/troubleshooting.adoc[Решение проблем] - отладка подключений.
