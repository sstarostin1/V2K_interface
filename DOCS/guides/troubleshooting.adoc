= Решение проблем

// Метаданные для машинной читаемости
:component: troubleshooting
:tags: [руководство, проблемы, отладка, решение]
:dependencies: [VCAS Server Viewer, логи]
:related: [guides/installation.adoc, guides/user-guide.adoc]

== Общие проблемы и решения

=== PyQt5 не устанавливается

*Проблема*: Ошибка при установке PyQt5 через pip.

*Решение*:
* Установите системные зависимости:
+
[source,bash]
----
sudo apt install python3-pyqt5  # для Ubuntu/Debian
----
* Или используйте conda:
+
[source,bash]
----
conda install pyqt
----

=== PyQtVChannels не найдена

*Проблема*: Библиотека PyQtVChannels недоступна.

*Решение*:
* Убедитесь, что библиотека установлена в системе
* Скачайте с GitHub или получите от разработчиков ВЭПП-2000
* Установите вручную:
+
[source,bash]
----
pip install path/to/PyQtVChannels
----

=== Ошибка подключения к серверу

*Проблема*: Приложение не может подключиться к VCAS серверу.

*Решение*:
* Проверьте доступность сервера:
+
[source,bash]
----
ping 172.16.1.110  # для реального сервера
ping 127.0.0.1     # для mock сервера
----
* Проверьте порт 20041/20042
* Используйте mock сервер для тестирования:
+
[source,bash]
----
python main.py --mock-server
----

=== Дерево каналов пустое

*Проблема*: После подключения дерево каналов не заполняется.

*Решение*:
* Проверьте логи в `vcas_viewer.log`
* Попробуйте принудительное обновление: Сервис → Принудительное обновление
* Перезапустите приложение
* Проверьте работу сервера

=== Информация о канале не обновляется

*Проблема*: Выбранный канал не показывает данные.

*Решение*:
* Кликните по другому каналу и обратно
* Используйте Сервис → Очистить кэш
* Проверьте логи на ошибки запросов
* Убедитесь, что канал существует на сервере

=== Приложение зависает

*Проблема*: GUI не отвечает на действия.

*Решение*:
* Подождите завершения сетевых операций
* Проверьте подключение к серверу
* Перезапустите приложение
* Проверьте системные ресурсы

== Отладка и логирование

=== Включение отладочного режима

[source,bash]
----
python main.py --debug
----

=== Просмотр логов

* Логи записываются в `vcas_viewer.log`
* Уровни: INFO (по умолчанию), DEBUG (с `--debug`)
* Содержат информацию о:
  * Подключениях и отключениях
  * Отправленных командах
  * Полученных ответах
  * Ошибках и исключениях

=== Анализ логов

* Ищите строки с "ERROR" или "WARNING"
* Проверьте последовательность подключения
* Сравните с успешными запусками

== Тестирование компонентов

=== Проверка зависимостей

[source,bash]
----
python test_dependencies.py
----

Ожидаемый вывод - все проверки пройдены.

=== Запуск mock сервера отдельно

[source,bash]
----
python run_mock_server.py --host 127.0.0.1 --port 20042 --debug
----

Проверьте логи сервера на ошибки.

=== Тестирование подключения

[source,bash]
----
# В отдельном терминале запустите mock сервер
python run_mock_server.py --port 20042

# В другом терминале подключитесь
python main.py --mock-server
----

== Распространенные ошибки

=== "ModuleNotFoundError: No module named 'PyQt5'"

*Решение*: Установите PyQt5 правильно для вашей системы.

=== "Connection refused"

*Решение*: Сервер не запущен или недоступен. Используйте mock режим.

=== "Channel not found"

*Решение*: Канал не существует на сервере. Проверьте имя канала.

=== "Access denied"

*Решение*: Недостаточно прав для доступа к каналу.

== Профилактика проблем

* Всегда запускайте `test_dependencies.py` после установки
* Используйте mock режим для разработки и тестирования
* Регулярно проверяйте логи на наличие ошибок
* Делайте резервные копии настроек перед изменениями

== Когда обращаться за помощью

Если проблема не решена:

1. Соберите информацию:
   * Версия Python и ОС
   * Вывод `test_dependencies.py`
   * Содержимое `vcas_viewer.log`
   * Шаги для воспроизведения ошибки

2. Опишите проблему:
   * Что вы пытались сделать
   * Что произошло вместо ожидаемого
   * Сообщения об ошибках

3. Обратитесь к разработчикам ВЭПП-2000 или в техническую поддержку

Связанные документы:

* xref:guides/installation.adoc[Установка и настройка] - проверка зависимостей
* xref:guides/user-guide.adoc[Руководство пользователя] - правильное использование
* xref:development/testing.adoc[Тестирование] - проверка функциональности
